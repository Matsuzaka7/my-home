"use strict";(self["webpackChunkheadline"]=self["webpackChunkheadline"]||[]).push([[314],{2314:function(e,t,o){o.r(t),o.d(t,{default:function(){return d}});var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-container"},[o("van-nav-bar",{staticClass:"page-nav-bar",attrs:{title:"登录","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),o("h4",{staticClass:"loginTitle"},[e._v("头条欢迎您")]),o("van-form",{ref:"loginForm",staticClass:"form",on:{submit:e.onSubmit}},[o("van-field",{attrs:{name:"mobile",placeholder:"请输入手机号",rules:e.userFormRules.phone,maxlength:"11",type:"number"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}},[o("i",{staticClass:"toutiao toutiao-shouji",attrs:{slot:"left-icon"},slot:"left-icon"})]),o("van-field",{attrs:{name:"code",placeholder:"请填写验证码",rules:e.userFormRules.code,type:"number",maxlength:"6"},scopedSlots:e._u([{key:"button",fn:function(){return[e.isCountDownShow?o("van-count-down",{staticStyle:{color:"#a699b3"},attrs:{time:6e4,format:"ss s"},on:{finish:function(t){e.isCountDownShow=!1}}}):o("van-button",{staticClass:"sendCode",attrs:{"native-type":"button",size:"mini",round:""},on:{click:e.onSendSms}},[e._v("发送验证码")])]},proxy:!0}]),model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}},[o("i",{staticClass:"toutiao toutiao-yanzhengma",attrs:{slot:"left-icon"},slot:"left-icon"})]),o("div",{staticClass:"isRememberUser"},[o("van-checkbox",{attrs:{"icon-size":"18px"},model:{value:e.isRemember,callback:function(t){e.isRemember=t},expression:"isRemember"}},[e._v("记住手机号")])],1),o("div",{staticClass:"btnBox"},[o("van-button",{attrs:{round:"",block:"",type:"info","native-type":"submit"}},[e._v("登录/注册")])],1)],1),o("span",{staticClass:"code-text"},[e._v("验证码为 246810")])],1)},n=[],r=o(5155),a=o(1718),i=o(7139),u={name:"loginIndex",data(){return{user:{mobile:(0,a.rV)("user-phone")||"13800000000",code:""},isRemember:(0,a.rV)("user-phone")?1:0,userFormRules:{phone:[{required:!0,message:"请输入手机号"},{pattern:/1[3|5|7|8|9|4|6]\d{9}$/,message:"手机号格式错误!"}],code:[{required:!0,message:"请填写验证码"},{patter:/\d[6]/,message:"验证码格式错误"}]},isCountDownShow:!1}},methods:{async onSubmit(){i.Z.loading({message:"登录中...",forbidClick:!0,duration:0});const e=this.user;try{const{data:t}=await(0,r.x4)(e);this.$store.commit("setUser",t.data),this.$store.commit("delCachePage","LayoutIndex"),i.Z.success({message:"登录成功!",forbidClick:!0}),this.isRemember?(0,a.LS)("user-phone",this.user.mobile):(0,a.LS)("user-phone",null),this.$router.back()}catch(t){i.Z.fail({message:"登录失败!请重试",forbidClick:!0})}},async onSendSms(){try{await this.$refs.loginForm.validate("mobile")}catch(e){return e}this.isCountDownShow=!0;try{await(0,r.Q6)(this.user.mobile),i.Z.success("发送成功")}catch(e){this.isCountDownShow=!1,i.Z.fail("发送失败,请稍后重试")}}}},l=u,c=o(1001),m=(0,c.Z)(l,s,n,!1,null,"1eed1bfb",null),d=m.exports},5155:function(e,t,o){o.d(t,{Ci:function(){return i},Lj:function(){return m},Q6:function(){return r},R3:function(){return u},W9:function(){return d},X5:function(){return f},bG:function(){return a},dX:function(){return b},et:function(){return c},lQ:function(){return p},qi:function(){return h},x4:function(){return n},zM:function(){return l}});var s=o(8029);o(4901);const n=e=>(0,s.Z)({method:"POST",url:"/v1_0/authorizations",data:e}),r=e=>(0,s.Z)({method:"GET",url:`/v1_0/sms/codes/${e}`}),a=()=>(0,s.Z)({method:"GET",url:"/v1_0/user"}),i=()=>(0,s.Z)({method:"GET",url:"/v1_0/user/channels"}),u=e=>(0,s.Z)({method:"POST",url:"/v1_0/user/followings",data:{target:e}}),l=e=>(0,s.Z)({method:"DELETE",url:`/v1_0/user/followings/${e}`}),c=()=>(0,s.Z)({method:"GET",url:"/v1_0/user/profile"}),m=e=>(0,s.Z)({method:"PATCH",url:"/v1_0/user/profile",data:e}),d=e=>(0,s.Z)({method:"PATCH",url:"/v1_0/user/photo",data:e}),h=()=>(0,s.Z)({method:"GET",url:"/v1_0/article/collections"}),f=()=>(0,s.Z)({method:"GET",url:"/v1_0/user/histories",params:{page:1,per_page:200}}),b=()=>(0,s.Z)({method:"GET",url:"/v1_0/user/followers",params:{page:1,per_page:200}}),p=()=>(0,s.Z)({method:"GET",url:"/v1_0/user/followings",params:{page:1,per_page:200}})}}]);